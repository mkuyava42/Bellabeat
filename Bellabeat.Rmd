---
title: "Bellabeat"
author: "Marisa Kuyava"
output:
  pdf_document: default
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## **How can a wellness company play it smart?**

### **1. Introduction**

#### **Company** 

[Bellabeat](https://bellabeat.com/)

-   Bellabeat develops beautifully designed, high-tech, health-focused smart products for women.

##### **Stakeholders** 

-   Urška Sršen: Chief Creative Officer and Bellabeat Cofounder
-   Sando Mu: Key member of executive team and Bellabeat Cofounder
-   The Bellabeat Marketing Analytics team: Responsible for collecting, analyzing, and reporting data


### **2. Ask**
##### **Scenario** 

As a data analyst on the Bellabeat marketing analyst team I have been tasked with analyzing public smart device data to gain insight into how smart devices are being used by consumers.

##### **Goal** 

Provide insights on trends in smart device usage that will help unlock new growth opportunities for the company and help guide marketing strategies.


### **3. Prepare**
##### Libraries Utilized:

-   tidyverse
-   dplyr
-   here
-   janitor
-   lubridate
-   skimr
-   ggplot2

```{r libraries, include=FALSE}

# Libraries utilized in data cleaning, organization and analysis 
library(tidyverse)
library(dplyr)
library(here)
library(janitor)
library(lubridate)
library(skimr)
library(ggplot2)
library(gridExtra)
```

#### **Data**

**Storage and Accessibility**\

The data set being analyzed is [FitBit Fitness Tracker Data](https://www.kaggle.com/datasets/arashnic/fitbit) provided on [Kaggle](https://www.kaggle.com). The data set was generated by thirty eligible FitBit user respondents, to a distributed survey via Amazon Mechanical Turn, between the dates of April 12, 2016 and May 12, 2016. These users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring.

**Organization and ROCCC**\

-   The data is provided in 18 CSV files, after reviewing the data it was determined that the data in the files imported below contain the most complete and relevant data. The data was cleaned, including checking for duplicate files, and formats were standardized to ensure completeness and accuracy.
-   The data set is obsolete for analyzing current trends as it was gathered in 2016.
-   Data set sample size is limited to 30 individuals; this is the smallest sample size possible to be statistically in representing the population. A larger sample size would provide a higher confidence level, a decrease margin of error and a greater statistical significance.
-   Data is possibly not relevant for the customers Bellabeat targeted audience as the data provided does not provide user respondents gender.
-   Some data provided was manually entered and could contain error of be incorrect information.

**Variables Measured**\

-   Steps
-   Sleep
-   Calories
-   Intensity

#### **Data Import**

-   6 of 18 files will be used as data provided in the other files are a duplication.
-   Data was imported and each file was confirmed as successfuly uploaded.

**Daily Activity**

```{r Dataset Import Daily Activity, echo=FALSE}
daily_activity <- read.csv("Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv")
str(daily_activity)
```

**Daily Sleep**

```{r Dataset Import Daily Sleep, echo=FALSE}
daily_sleep <- read.csv("Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv")
str(daily_sleep)
```

**Hourly Calories**

```{r Dataset Import Hourly Calories, echo=FALSE}
hourly_calories <- read.csv("Fitabase Data 4.12.16-5.12.16/hourlyCalories_merged.csv")
str(hourly_calories)

```

**Hourly Intensity**

```{r Dataset Import Hourly Intensity, echo=FALSE}
hourly_intensity <- read.csv("Fitabase Data 4.12.16-5.12.16/hourlyIntensities_merged.csv")
str(hourly_intensity)
```

**Hourly Steps**

```{r Dataset Hourly Steps, echo=FALSE}
hourly_steps <- read.csv("Fitabase Data 4.12.16-5.12.16/hourlySteps_merged.csv")
str(hourly_steps)
```

**Weight**

```{r Dataset Import Weight, echo=FALSE}
weight <- read.csv("Fitabase Data 4.12.16-5.12.16/weightLogInfo_merged.csv")
str(weight)
```
### **4. Process**

#### **Data Cleaning**

-   Data set was checked for duplicates and missing values.
-   Duplicate data was removed from the dataset
-   Dates and date column name within the data set were all normalized
-   Individual files were merged for easier analysis

```{r Dataset Duplicates and missing values, include=FALSE}

#Checking all files for duplicates and missing values.

sum(duplicated(daily_activity))
sum(is.na(daily_activity))

sum(duplicated(daily_sleep))
sum(is.na(daily_sleep))

sum(duplicated(hourly_calories))
sum(is.na(hourly_calories))

sum(duplicated(hourly_intensity))
sum(is.na(hourly_intensity))

sum(duplicated(hourly_steps))
sum(is.na(hourly_steps))

sum(duplicated(weight))

#Remove duplicates from daily_sleep and recheck
daily_sleep <- daily_sleep[!duplicated(daily_sleep),]
sum(duplicated(daily_sleep))

```

```{r Dataset Normalizing, include=FALSE}

#Setting date/time formats on all data to be uniform

daily_activity$ActivityDate <- as.Date(daily_activity$ActivityDate, format = "%m/%d/%Y")
daily_activity <- daily_activity %>% rename(Date = ActivityDate)

daily_sleep$SleepDay <- as.Date(daily_sleep$SleepDay, format = "%m/%d/%Y")
daily_sleep <- daily_sleep  %>% rename(Date = SleepDay)

weight$Date <-  as.Date(weight$Date, format = "%m/%d/%Y")

hourly_intensity$ActivityHour <- mdy_hms(hourly_intensity$ActivityHour)
hourly_intensity$Hour <- hour(hourly_intensity$ActivityHour)

hourly_steps$ActivityHour <- mdy_hms(hourly_steps$ActivityHour)
hourly_steps$Hour <- hour(hourly_steps$ActivityHour)

hourly_calories$ActivityHour <- mdy_hms(hourly_calories$ActivityHour)
hourly_calories$Hour <- hour(hourly_calories$ActivityHour)
```

```{r Dataset Merge, include=FALSE}

# Daily Activity and Daily Sleep 
daily_all_merged <- merge(daily_activity, daily_sleep, by = c("Id", "Date"))

# Hourly Calories and Hourly Intensity
hourly_calories_intensity <- merge(hourly_calories, hourly_intensity, by = c("Id", "ActivityHour", "Hour"))
hourly_calories_steps <- merge(hourly_calories, hourly_steps, by = c("Id", "ActivityHour", "Hour"))

# Merged Hourly Calories)Intensity and Hourly Steps
hourly_all_merged <- merge(hourly_calories_intensity, hourly_calories_steps, by = c("Id", "ActivityHour", "Hour"))

```

### **5. Analyze**

#### **Data Analysis**

**Data Summary - Distances**

```{r Dataset Summary Distance, echo=FALSE}
#Distance
daily_all_merged %>%
  select(Steps_Total = TotalSteps,
         Distance_Total = TotalDistance,
         High_Activity = VeryActiveDistance,
         Mid_Activity = ModeratelyActiveDistance,
         Low_Activity = LightActiveDistance) %>%
  summary()
```

**Standard Deviations - Distances**

```{r Standard Deviations, echo=FALSE}
print(paste("Steps_Total:             ",round(sd(daily_all_merged$TotalSteps), digits = 4)))
print(paste("Distance_Total:          ",round(sd(daily_all_merged$TotalDistance), digits = 4)))
print(paste("High_Activity_Distance:  ",round(sd(daily_all_merged$VeryActiveDistance), digits = 4)))
print(paste("Mid_Activity_Distance:   ",round(sd(daily_all_merged$ModeratelyActiveDistance), digits = 4)))
print(paste("Low_Activity_Distance:   ",round(sd(daily_all_merged$LightActiveDistance), digits = 4)))

```

**Data Summary - Time**

```{r Dataset Summary Time, echo=FALSE}
#Time
daily_all_merged %>%
  select(High_Active_Min = VeryActiveMinutes,
         Mid_Activive_Min = FairlyActiveMinutes,
         Low_Activive_Min = LightlyActiveMinutes,
         Sedentary_Min = SedentaryMinutes,
         Asleep_Min = TotalMinutesAsleep,
         InBed_Min = TotalTimeInBed,
         Calorie = Calories) %>%
  summary()

```

**Standard Deviations - Time**

```{r Standard Deviations Time, echo=FALSE}
print(paste("High_Activity_Minutes:  ",round(sd(daily_all_merged$VeryActiveMinutes), digits = 4)))
print(paste("Mid_Activity_Minutes:   ",round(sd(daily_all_merged$FairlyActiveMinutes), digits = 4)))
print(paste("Low_Activity_Minutes:   ",round(sd(daily_all_merged$LightlyActiveMinutes), digits = 4)))
print(paste("Sedentary_Minutes:      ",round(sd(daily_all_merged$SedentaryMinutes), digits = 4)))
print(paste("Asleep_Minutes:         ",round(sd(daily_all_merged$TotalMinutesAsleep), digits = 4)))
print(paste("InBed_Minutes:          ",round(sd(daily_all_merged$TotalTimeInBed), digits = 4)))
print(paste("Calories Burned:        ",round(sd(daily_all_merged$Calories), digits = 4)))
```

**Observations from statistical Summary**\

-   Users average a distance of 6.27 miles and 8515 steps daily
-   There is a significant variation between users activity as the standard deviation for distance is 3 and for steps is 4157
-   Users spend the most time doing Low activity, this correlates with low activity distance being the greatest
-   Users burn an average of 2389 calories per day
-   Users average sleep time is 6.98 hours with time in bed at 7.65 hours

#### **Activity Summary**

```{r Dataset Activity Levels, echo=FALSE}

activity_low <- sum(daily_all_merged$TotalSteps <= 5000, na.rm = TRUE)
activity_mid <- sum(daily_all_merged$TotalSteps > 5000 & daily_all_merged$TotalSteps < 10000, na.rm = TRUE)
activity_high<- sum(daily_all_merged$TotalSteps >= 10000, na.rm = TRUE)

activity_levels <- data.frame(
  c(activity_low, activity_mid, activity_high),
  c(((activity_low)/(activity_low + activity_mid + activity_high)*100),
    ((activity_mid)/(activity_low + activity_mid + activity_high)*100),
    (activity_high)/(activity_low + activity_mid + activity_high)*100),
    c("Less than 5000", "More than 5000 and Less than 1000", "Equal or Greater than 10000" )) 

  rownames(activity_levels) <- c("Low Steps", "Mid Steps", "High Steps")
  colnames(activity_levels) <- c("Count", "Percentage", "Steps")
  activity_levels
```

 **Observations from Activity Summary**

-   The majority of users have mid to high activity at 76%
-   40% reaching the recommended 10K steps per day
-   23% of users are well below the recommended 10K steps per day

#### **Sleep Correlations**

```{r Correlations with Sleep, echo=FALSE}

correlation <- daily_all_merged[c(3,4,11:14,15,17,18)] 
correlation_maxtrix <- cor(correlation, use="complete.obs")
correlation_sleep <- data.frame(correlation_maxtrix[,8])
colnames(correlation_sleep) <- "Correlation of Minutes Asleep"
correlation_sleep

```

**Observations from Sleep Correlations**

-   There is a moderate negative correlation between sleep and Sedentary Minutes, this suggests that users sleep better when their Sedentary Minutes are lower.

```{r Correlations Plot Asleep & Sedentary Minutes, echo=FALSE, message=FALSE, warning=FALSE}

##Graphical representation of the relationship between Sedentary Minutes and Asleep Minutes 

daily_all_merged %>% 
  group_by(SedentaryMinutes, TotalMinutesAsleep) %>% #Graphical representation of the relationship between 
  ggplot(aes(x = SedentaryMinutes, y = TotalMinutesAsleep, color = TotalMinutesAsleep)) +
  geom_point() +
  geom_smooth(color = "Orange") + 
    theme(plot.title = element_text(size = 18, face = "bold"),
          plot.subtitle = element_text(size = 10, face = "italic"),
        legend.position = c(.8, .8),
        legend.spacing.y = unit(2, "mm"), 
        panel.border = element_rect(colour = "black", fill=NA),
        legend.background = element_blank(),
        legend.box.background = element_rect(colour = "black"))  +
  
  labs(title = 'Sleep & Sedentary Time',
        subtitle = "Minutes Alseep decrease as Sedentary Minutes increase",
       y = 'Minutes Asleep',
       x = 'Sedentary Minutes')
```

#### **Calorie Correlations**

```{r Correlations with Calories, echo=FALSE}

correlation_calories <- data.frame(correlation_maxtrix[,7])
colnames(correlation_calories) <- "Correlation of Calories"
correlation_calories

```

**Observations from Calories Correlations**

-   There is a strong positive correlation between Total Steps, Distance, Active Minutes and Calories burned; as expected.
-   Total Distance and Total Steps both have a positive correlation with Calories burned; distance having a slightly stronger correlation

```{r Correlations Charts Calories & Steps vs Distance, echo=FALSE, message=FALSE, warning=FALSE}

calorie_distance_plot <- ggplot(data=daily_all_merged, aes(x=TotalDistance, y=Calories, colour=TotalDistance))+
geom_point() + geom_smooth() +
    ggtitle("Calories & Distance") +
    theme(plot.title = element_text(hjust = 0.5, size = 18, face = "bold"))

calorie_steps_plot <- ggplot(data=daily_all_merged, aes(x=TotalSteps, y=Calories, colour=TotalSteps))+
geom_point() + geom_smooth() +
    ggtitle("Calories & Steps") +
    theme(plot.title = element_text(hjust = 0.5, size = 18, face = "bold"))

grid.arrange(calorie_distance_plot, calorie_steps_plot, nrow=2)

```

#### **Most Active Times**\
**User activity has a correlation to the time of day and day of the week**

```{r Hourly Intensity, echo=FALSE, warning=FALSE}
hourly_all_merged %>%
  group_by(Hour) %>%
    ggplot(data = hourly_all_merged, mapping = aes(x=Hour,y=AverageIntensity)) + geom_histogram(stat = "identity", fill="Blue")+
    geom_hline(aes(yintercept = 300), color="green" ) +
    geom_hline(aes(yintercept = 250)) +
    geom_hline(aes(yintercept = 200), color="yellow" ) +
    geom_hline(aes(yintercept = 150)) +
    geom_hline(aes(yintercept = 100), color="red" ) +
    geom_hline(aes(yintercept = 50)) +
    theme(axis.text.x = element_text(angle = 45)) +
    ggtitle("Active Time of Day") +
    theme(plot.title = element_text(hjust = 0.5, size = 18, face = "bold"))


```



**Active Hours**

-   Very Active 08:00 -20:00
-   Mid Active 06:00 - 08:00 / 20:00 -22:00
-   Low Active 23:00 - 6:00

```{r Daily Table, warning=FALSE, include=FALSE}
active_days <- daily_all_merged %>%
  mutate(week_day = weekdays(Date), TotalSteps, TotalDistance)

active_days$week_day <- ordered(active_days$week_day, levels = 
  c("Monday", "Tuesday", "Wednesday", "Thursday",
  "Friday", "Saturday", "Sunday"))

active_day <- active_days  %>%
  group_by(week_day) %>%
  summarize(daily_steps = mean(TotalSteps), daily_distance = mean(TotalDistance))

active_day

```

```{r Daily Plot, echo=FALSE, warning=FALSE}

daily_steps_plot = ggplot(data = active_day, mapping = aes(x=week_day,y=daily_steps)) + geom_col(fill="Blue" )+
 theme(axis.text.x = element_text(angle = 45)) +
    ggtitle("Daily Steps") +
    theme(plot.title = element_text(hjust = 0.5, size = 18, face = "bold"))

daily_steps_distance = ggplot(data = active_day, mapping = aes(x=week_day,y=daily_distance)) + geom_col(fill="Blue" )+
 theme(axis.text.x = element_text(angle = 45)) +
    ggtitle("Daily Distance") +
    theme(plot.title = element_text(hjust = 0.5, size = 18, face = "bold"))  

grid.arrange(daily_steps_plot, daily_steps_distance, nrow=1)
```

**Active Days**

-   Users are most active on Saturday, followed by Monday and Tuesday respectively
-   Mid-week (Wednesday, Thursday, Friday) has slightly lower activity
-   Sunday is the lowest activity day

### **6. Act**

#### **Findings and Recommendations**


**Observations**

- Users average a daily distance of 6.27 miles and 8515, however as the standard deviation is 3 miles  and 4157 steps there is a significant variation between the activities of the users
- Users spend the most time in low impact activity and only 40% are meeting or exceeding the recommended 10K daily steps
- Users with higher sedentary time have lower time spent asleep
- Users are most active on Saturdays, Mondays and Tuesdays with mid day and evening hours having the highest activity


**Recommendations**

Functionality:

  - Gamification: Incorporating both individual and competitive goals, rewards, streaks, and achievements can help increase user engagement and activity.
  - Recommendations for active lifestyle and quality sleep strategies can add additional value for the user 
  - Social Networking: Providing in-app chat ability and user interaction can promote exercise habits and enhance user engagement. Have a community provides accountability and motivation for the users to be active. 
  
  - Alerts:
    - Give users the ability to set alerts and reminders  
      - Daily exercise and sleep reminders
      - Step count notifications through out the day
      - Extended period sedentary time warning for a break reminder and to encourage activity

**Data**

- The data analysis was done on a very limited and dated data set - Additional analysis with Bellabeat's tracking data recommended

** **

